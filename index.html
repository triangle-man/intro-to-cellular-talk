<!DOCTYPE html>
<html>
<head>
  <!-- Adobe TypeKit code for fonts -->
  <script src="https://use.typekit.net/hws4qsv.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>
  <!-- -->
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="James Geddes">
  <title>Cellular:</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/ati.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
  <h1 class="title">Cellular:</h1>
  <h1 class="subtitle">A proposal for better spreadsheets</h1>
  <h2 class="author">James Geddes</h2>
  <h3 class="date">May 2016</h3>
</section>

<section id="the-west-coast-mainline-débâcle" class="slide level2">
<h1>The West Coast Mainline débâcle</h1>
<figure>
<img src="images/virgin-train.jpg" alt="Photo: Aaron Roberts https://www.flickr.com/photos/aaronsrailwayphots/ (CC BY-NC 2.0)" /><figcaption>Photo: Aaron Roberts https://www.flickr.com/photos/aaronsrailwayphots/ (CC BY-NC 2.0)</figcaption>
</figure>
<aside class="notes">
<p>In 2012, the franchise to run the train service on the West Coast intercity routes, at that time run by Virgin, was sent out to tender. Bidding companies submitted details of their bid, including detailed financial projections, to the Department for Transport. A company called FirstGroup won the bid and Virgin promptly launched a legal challenge.</p>
<p>As a result of the challenge, the award was scrapped. Three civil servants were suspended. Apparently at least £40m was paid to the bidders in compensation. A review found &quot;significant technical flaws&quot; in the way the bidding process was run.</p>
<p>At the heart of those technical flaws appears to have been a large spreadsheet.</p>
</aside>
</section>
<section id="its-not-just-government" class="slide level2">
<h1>It's not just government</h1>
<aside class="notes">
<p>Here's another example.</p>
<p>There were several problems with Reinhart and Rogoff's paper, some of which were simply debatable assumptions, and these had a greater effect on the result than the spreadsheet error. However, it was unarguable that there was a spreadsheet error. It was an illuminating one, and we'll take a look at it later.</p>
</aside>
<hr/>
<p>Carmen M. Reinhart, Kenneth S. Rogoff (2010). &quot;Growth in a Time of Debt&quot;. <em>American Economic Review</em> <strong>100</strong> (2): 573–78.</p>
<hr/>
<blockquote>
<p>“George Osborne’s favourite ‘godfathers of austerity’ economists admit to making error in research” — the <em>Mirror</em></p>
</blockquote>
<blockquote>
<p>“The Rogoff-Reinhart data scandal reminds us economists aren’t gods” — <em>The Guardian</em></p>
</blockquote>
<blockquote>
<p>“The Excel Depression” — Paul Krugman</p>
</blockquote>
</section>
<section id="and-some-limitations-are-fundamental" class="slide level2">
<h1>And some limitations are fundamental</h1>
<figure>
<img src="images/FIT_Evidence_Review.png" alt="Source: DECC, Performance and Impact of the Feed-In Tariff Scheme: Review of Evidence" style="width:80.0%" /><figcaption>Source: DECC, Performance and Impact of the Feed-In Tariff Scheme: Review of Evidence</figcaption>
</figure>
<aside class="notes">
<ol type="1">
<li><p>Where is the uncertainty?</p></li>
<li>What should we do in year 2?</li>
</ol>
</aside>
</section>
<section class="slide level2">

<figure>
<img src="images/algorithms.png" alt="Cartoon by Randall Munroe, http://xkcd.com/1667/ (cc by-nc 2.5)" /><figcaption>Cartoon by Randall Munroe, http://xkcd.com/1667/ (cc by-nc 2.5)</figcaption>
</figure>
<aside class="notes">
<p>Hello. My name is James Geddes and I have some bad news for you: the world runs on Excel.</p>
<p>From 2002 to 2009 I was a strategy consultant. I helped some of the largest companies in the world make decisions. I helped an airline open a new transatlantic route; I helped a mining company improve the performance of their mines; I even had the privilege of helping a chain of pubs set the price of beer.</p>
<p>How did I know what to advise our clients? I built models. A model is a mathematical simplification of the world. It keeps you honest. It lets you test out your ideas. If I make such-and-such a change, what will happen to my profits?</p>
<p>I worked for one of the most prestigious stategy consulting firms. We pride ourselves on our quantitative focus. We must use some pretty amazing modelling tools, right? Well, we used Excel. Excel <em>is</em> pretty amazing in some ways -- it's amazing because <em>everyone can use it</em>. It's less amazing in other ways.</p>
<p>From 2009 to 2014 I worked at the Department of Energy and Climate Change. I worked with a team attempting to answer the question, how do we reduce the UK's greenhouse gas emissions by 80% over the next 40 years? To answer this question, we built a model: I was the architect of this model although you could say that the godfather of the model was David MacKay. The model simulated the entire energy system of the UK for 40 years. We must have used some pretty complex software, right? Well, we used Excel. It <em>was</em> a pretty sophisticated Excel model in some ways. Less so in others.</p>
<p>Directly as a result of the West Coast mainline debacle, the government produced a review -- the MacPherson review -- to explain how to build and quality assure models properly. That review cited the 2050 model as one of its examples of how to do it right.</p>
<p>Government runs on Excel. That's what government analysts use. Often, of course, analysis is outsourced to a technical consulting company. <em>They</em> might use linear programming or something. But in government: Excel.</p>
<p>Later on, we helped other governments build their own versions of the model. China build one, India built one, even Wallonia built one. Each time we helped a country build their model we would reconstruct our enormous Excel spreadsheet, painfully making hundreds of manual changes, introducing errors as we did so.</p>
<p>Well, I've had enough. I never want to build another Excel model again. Cellular is my plan.</p>
<p>Visicalc (1979) was the “killer app” for the Apple II. You bought an Apple II because you wanted to run Visicalc. Lotus 1-2-3 was the killer app for PCs. Microsoft Multiplan -- 1982 Lotus 1-2-3 -- 1983 Excel Mac -- 1985 Excel Windows -- 1987 Quattro Pro -- 1988 (Intended to compete with Lotus, still available from Corel(!)) Improv -- 1991 (Innovative -- separated data, view, and formulas) Analytica -- 1996 Google -- 2006</p>
</aside>
</section>
<section class="slide level2">

<!-- ========================= TABLE OF CONTENTS ========================== -->
<p>Background to spreadsheet modelling</p>
<p>The challenge of doing better</p>
<p>Cellular</p>
<p>The challenge of doing cellular</p>
<!-- =================== A BRIEF HISTORY OF SPREADSHEETS ================== -->
</section>
<section id="background-to-spreadsheet-modelling" class="slide level2">
<h1>Background to spreadsheet modelling</h1>
</section>
<section class="slide level2">

<figure>
<img src="images/spreadsheet-history.png" />
</figure>
</section>
<section id="visicalc-the-first-killer-app" class="slide level2">
<h1>VisiCalc: the first ‘killer app’</h1>
<figure>
<img src="images/Visicalc.jpg" alt="Screenshot of VisiCalc on the Apple II. Photo: apple2history.org" /><figcaption>Screenshot of VisiCalc on the Apple II. Photo: apple2history.org</figcaption>
</figure>
<aside class="notes">
<p>A quick word here about what I'm not going to discuss. VisiCalc did not have any sort of embedded programming environment. Excel does, however: it has Visual Basic for Applications, VBA. VBA is a complete programming language. Any of the restrictions I'm going to discuss could I suppose be worked around by sufficiently clever use of VBA. Indeed, I've built models with VBA -- particularly in order to automate some part of a workflow so that end-users did not have perform a series of manual steps.</p>
<p>I'm not going to make a strong argument here. Let me just say that I have never seen a model which includes VBA which is at all comprehensible. In terms of clarity and robustness, VBA has in my experience only ever made things worse.</p>
</aside>
</section>
<section id="excel-has-been-dominant-for-20-years" class="slide level2">
<h1>Excel has been dominant for 20 years</h1>
<figure>
<img src="images/spreadsheet-ngrams.png" alt="A history of spreadsheets. Source: Google ngrams." /><figcaption>A history of spreadsheets. Source: Google ngrams.</figcaption>
</figure>
<aside class="notes">
<p>Excel has, perhaps, on the order of 750 million users.</p>
</aside>
<!-- =================== THE CHALLENGE OF DOING BETTER  ================== -->
</section>
<section id="the-challenge-of-doing-better" class="slide level2">
<h1>The challenge of doing better</h1>
</section>
<section class="slide level2">

<figure>
<img src="images/reinhart_rogoff_ss.png" alt="Reinhart and Rogoff’s spreadsheet. Source: Thomas Herndon, Michael Ash, and Robert Pollin via Mike Konczal" style="width:60.0%" /><figcaption>Reinhart and Rogoff’s spreadsheet. Source: Thomas Herndon, Michael Ash, and Robert Pollin via Mike Konczal</figcaption>
</figure>
<aside class="notes">
<ul>
<li><p>NB: Spreadsheet error was not the only issue taken with the paper. But it's a good example of the sort of errors that occur.</p></li>
<li>First, some structures that we see often in a spreadsheet:</li>
<li><p>A set of values down the left; a set of values across the top; and in the intersections values whose meaning is codified by the product of the row and column headers.</p>
<p>There are many ways to lay out a spreadsheet; this is one of them. It has the virtue of being structured and of conforming to the two dimensions available.</p></li>
<li><p>A expression whose arguments are a set of related data.</p></li>
<li>There are also some problems common to spreadsheets:</li>
<li><p>Metadata (formatting) used to convey meaning -- where is the key? Is it important?</p></li>
<li><p>Inputs, intermediate values, and outputs mixed up. A well-designed spreadsheet has a linear ordering of data flow: eg, top to bottom. Here is not clear what the &quot;maximum&quot; etc fields at the top are.</p></li>
<li><p>Hidden columns. What's going on in there?</p></li>
<li><p>And of course the major problem with this spreadsheet, which is a simple formula error.</p></li>
<li><p>How can we fix this kind of error?</p></li>
</ul>
</aside>
</section>
<section id="how-do-we-make-good-software-in-general" class="slide level2">
<h1>How do we make good software in general?</h1>
<blockquote>
<p>The art of programming is the art of organising complexity [...] — <em>Edsger W. Dijkstra</em> (1930–2002)</p>
</blockquote>
<blockquote>
<p>Controlling complexity is the essense of computer programming. — <em>Brian Kernighan</em> (1942–)</p>
</blockquote>
<ol type="1">
<li><p>Divide and conquer</p></li>
<li><p>Say what you mean</p></li>
<li><p>Don’t repeat yourself</p></li>
</ol>
<p>How does Excel do on these three measures?</p>
</section>
<section class="slide level2">

<ul>
<li><p>Separation of concerns (aka, divide and conquer) <img src="images/ss-tabs.png" style="width:65.0%" /></p></li>
<li><p>Don't repeat yourself (aka, generalise) <img src="images/ss-dry-fail.png" style="width:65.0%" /></p></li>
<li><p>Say what you mean (aka, abstract)</p>
<pre><code>=IFERROR(INDEX(INDIRECT($C10 &amp; &quot;.Outputs[&quot; &amp; this.Year &amp; &quot;]&quot;),
           MATCH(G$5, INDIRECT($C10 &amp; &quot;.Outputs[Vector]&quot;), 0)), 0)</code></pre></li>
</ul>
<aside class="notes">
<p>Let me outline for you some of the challenges faced by spreadsheet modellers. I'm going to spend some time on this slide and the next one.</p>
<p>Consider in particular three good practices in software development. There are many practices, of course, such as: unit testing, requirements specification, coding conventions, and what have you; but these three seem to ne to get to the essence of <em>programming</em> as opposed to an arbitrary technical design activity.</p>
<p>First of all, if you have a complicated problem, you should break it down into subproblems, each of which is simpler.</p>
<p>In some sense, Excel does quite well here. Of course, it's up to the modeller to correctly choose the subproblems, but once she does so, Excel provides some presentational techniques to help manage the separation. One can place different tasks on different worksheets, for example, or, for simple submodels, in different rows or columns.</p>
<p>Most good modellers will do precisely this. Indeed, organisations typically set up standards for the use of each worksheet: here's an example of one such.</p>
<p>Still, it's not great. It's not enough simply to separate different parts of the model: one must define the ways in which the parts interact. Most programming languages have some facility for constructing the interface between components. That facility will typically ensure that the components cannot be used except through the interface, a constraint known as &quot;information hiding&quot; -- not keeping secrets, but making sure that it's clear how and when one part of the model interacts with another. In Excel one must enforce such separation through convention and practice. For example, in the 2050 Calculator, we made a rule that inputs to a worksheet must exist only in a defined block at the top of the worksheet; when those values were needed somewhere in the worksheet, they were taken from that block at the top, not directly from source.</p>
<p>And perhaps this principle finds its most useful expression in the design of &quot;libraries&quot;: pre-built software components that perform some task commonly used in other programs. Almost every Excel model is built <em>de novo</em>. There's no &quot;import workbook&quot;. (Well, you can copy and paste but that never leads anywhere good.) Real models of the real world involve physical units and every spreadsheet that uses units has an <em>ad hoc</em> solution to the problem. It would be nice to solve this problem once and allow modellers to re-use that solution. It would be even nicer if, when we discovered bugs in or made improvements to our common solution, those changes could painlessly be incorporated in users' models.</p>
<p>And there's a further problem, which is related to the second practice. Only a certain kind of concern can be separated in Excel. Specifically, it must be a defined step in the data flow process.</p>
<p>What other concerns might there be? Well, one might wish to abstract some calculation and the re-use it. Here we have a problem. It is very hard to do this in Excel. About the best we can do is copy the calculation from one cell to another and make sure that references to other cells are made relative to the copied cell. We can assume that this is what was done, for example, in the Reinhart and Rogoff model.</p>
<p>Why is this a problem? It's a problem because we are repeating ourselves. Once we repeat ourselves, inevitably one of those repetitions will be wrong. There's no way to tell Excel, &quot;look, this is the same calculation, so make sure you really are computing the same calculation.&quot;</p>
<p>(Note to experienced modellers: array formulae are a thing that exists, of course. In some sense, array formulae are one of the most &quot;Excel-like&quot; things in Excel. But as you know, they have their own problems.)</p>
<p>Repeating larger blocks is much harder. Typically tyhe problem is that you want to repeat something <em>mutatis mutandis</em> and so the question is, how do you explain which mutandis must be mutatis? Here's an example from the 2050 Calculator.</p>
<p>You know -- just to say -- looking at that, isn't it absolutely clear that if you can do <em>that</em> -- surely, <em>surely</em> you could write some code!</p>
<p>Why did I write this monstrosity? So that an entire worksheet could be reproduced from a copy of another one, whilst making sure that the copy &quot;knew&quot; it was a copy.</p>
<p>Actually, this example is a good illustration of the challenges of the third principle. What does all this palavar <em>mean</em>? In a spreadsheet, every expression is written at the lowest level -- the only level. To work out what something is trying to do it's necessary to, well, work it out. We get around this with conventions -- naming conventions, formatting conventions, structure conventions -- but it's a very weak solution.</p>
<p>This formula looks up a particular energy flow from a particular sector for a particular year, making sure the result is zero if that kind of energy isn't produced or consumed by that sector. But you wouldn't know it to look at this.</p>
<p>It's worse than you think. Because of a flaw in the way certain references are implemented in Excel, one has to encode them in character strings! That, right there, will be -- and was -- an enormous source of bugs when you want to create a similar model.</p>
<p>So our tasks is clear: figure out how to introduce these development practices into a spreadsheet paradigm. But we must be careful.</p>
</aside>
</section>
<section id="spreadsheet-are-..." class="slide level2">
<h1>Spreadsheet are ...</h1>
<ol type="1">
<li><p>Concrete (not abstract)</p></li>
<li><p>Specific (not general)</p></li>
<li><p>Immediate (not deferred)</p></li>
</ol>
<aside class="notes">
<p>Here's our main problem. There's a <em>reason</em> that we can't apply those three software development practices in Excel, which is that spreadsheets don't support them. And the reason for that is that spreadsheets do support something else: they support people. Spreadsheets are concrete -- what you see is what there is. They are specific -- what they do is what they do. And they typically start with the data and transform it; rather than starting with a model and applying it to data.</p>
<p>There's a reason for these design issues: they make spreadsheets usable by people. If we're going to fix the problems they bring, we're going to have to tread carefully.</p>
<p>You know, there are two kinds of complexity in the world.</p>
<p>FIXME: Story of Ptolemaic epicycles (AD 100 ish) vs. Newton's laws (late 1600s) resulting in Keplerian motion (early 1610-1620s)</p>
<p>Spreadsheet programmers start with numbers. They organise these into tables, then they apply certain operations. At no time do they need to worry about names, although they can add names if they wish.</p>
</aside>
<!-- ===================== MODELLING WITH SPREADSHEETS ==================== -->
</section>
<section id="the-plan" class="slide level2">
<h1>The plan</h1>
<ol type="1">
<li><p>Observe that spreadsheets are already a lot like a simplistic programming language</p></li>
<li><p>Write this language explicitly, so that spreadsheets are written as programs (keeping the benefit/cost tradeoff positive!)</p></li>
<li><p>Generalise the language to include more powerful features (without losing the ease of use!)</p></li>
</ol>
</section>
<section id="every-spreadsheet-is-a-graph" class="slide level2">
<h1>Every spreadsheet is a graph</h1>
<pre><code>   |       A         |      B     |
===+=================+============+
 1 | Salary          |      21000 |
 2 | Allowance       |      11000 |
 3 | Taxable income  |  = B1 - B2 |
 4 | Basic rate      |        0.2 |
 5 | Tax payable     |  = B3 * B4 |</code></pre>
<figure>
<img src="images/graphviz/eg-tax-calc-expression-tree.png" />
</figure>
<aside class="notes">
<p>Here is a simple model written as a spreadsheet. It's a typical spreadsheet model. Computation proceeds from inputs to outputs; in this case from top-to-bottom. It's considered good design practice to lay out a spreadsheet in this way to aid in comprehension. In some sense, it's a primitive form of information hiding: if you want to find the values that enter into a particular computation you know that must look above the cell containing the computation.</p>
<p>The cells of any spreadsheet can be arranged as the nodes in a directed graph. A node in this graph is either a value or an expression of the values in other nodes and the arrows of the graph show which cells depend on which others. I am going to leave out the comments for these examples but clearly part of the challenge will be to figure out how to incorporate them since they play a key role in real spreadsheets.</p>
<p>The graph is acyclic: Excel will complain if the spreadsheet contains what it calls &quot;circular references&quot;. It is possible to force Excel to allow cycles, but models incorporating such features are thought of as something of a hack.</p>
<p>Some cells in this example have no dependencies nor are dependent on other cells: these are the labels, which I think are akin to comments in a program.</p>
<p>Well, now we have an expression graph. In fact, we have what looks very like an abstract syntax tree, such as built by a compiler. In which case, we ought to be able to write down one or more languages which &quot;compile to&quot; precisely this expression graph.</p>
<p>This language be extremely simple: it is a purely functional language with neither iteration nor recursion; nor are functions first-class values.</p>
</aside>
</section>
<section id="from-spreadsheet-to-program" class="slide level2">
<h1>From spreadsheet to program</h1>
<p>Topological sort:</p>
<figure>
<img src="images/graphviz/eg-tax-calc-expression-tree-linear.png" />
</figure>
<p>Then write out each step:</p>
<div class="sourceCode"><pre class="sourceCode pascal"><code class="sourceCode pascal">B1 := <span class="dv">21000</span>
B2 := <span class="dv">11000</span>
B3 := B1 - B2
B4 := <span class="dv">0.20</span>
B5 := B3 * B4</code></pre></div>
<p>In my view, the burden of naming is too high. But this language (&quot;grid&quot;?) could be used as a &quot;universal spreadsheet language&quot;.</p>
<aside class="notes">
<p>Here's one approach, which is almost a direct translation of the spreadsheet. We take the expression graph of the spreadsheet and linearise it. Note that</p>
<p>Then we simply bind the value of each node to a different symbol. Here I've chosen the symbols to be precisely the names of the cells that gave rise to this graph.</p>
<p>Execution proceeds in a single path: there are no branches or loops. (Conditionals are expressions.)</p>
<p>In this view, a program consists of a series of assignments, the left-hand side of which is a previously unused symbol and the right-hand side is an expression involving primitive operators and functions and previously-named symbols.</p>
<p>Any directed acyclic graph can be written in this way -- it doesn't have to be a tree as in this example.</p>
<p>So this could be our programming language. It has the nice feature that, as a &quot;step by step&quot; recipe, it appears to follow the spreadsheet modeller's thought process.</p>
<p>Of course, we'd still need some sensible way of assigning these variables to cells: a single column spreadsheet is not particularly user friendly.</p>
<p>A larger problem, in my view, is that this style imposes a cognitive burden on the modeller in that it requires the modeller to worry about things they don't want to worry about: specifically, naming things. Choosing names is hard, and the beauty of spreadsheets is that you don't have to choose names: you just use an empty cell. You don't even have to remember the name later, you can just point at the cell.</p>
<p>That barrier seems to me to be too high. My intuition is that spreadsheet modellers will find it too hard to create names. And why should they? This language is too low-level.</p>
<p>However, I think it is a good <em>final</em> target. It's like &quot;machine code for spreadsheets&quot;, in that, with the exception of layout, we could convert this into any particular spreadsheet: Excel, LibreOffice, Numbers, Google docs, and so on.</p>
<p>I propose the name &quot;grid&quot; for this language (which is still somewhat undefined).</p>
</aside>
</section>
<section id="from-program-to-spreadsheet-i" class="slide level2">
<h1>From program to spreadsheet (I)</h1>
<p>Conventional function syntax (built-in functions only):</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c">times(<span class="fl">0.20</span>, minus(<span class="dv">21000</span>, <span class="dv">11000</span>))</code></pre></div>
<p>Then:</p>
<ol type="1">
<li>Generate expression graph</li>
<li>Find its topological sort</li>
<li>Generate &quot;single static assignment&quot;</li>
<li>Lay out the result (in some clever way)</li>
</ol>
<p>Hypothesis: inversion of &quot;data flow programming&quot; mindset familiar to spreadsheet modellers is a barrier. (cf. magrittr in R.)</p>
<aside class="notes">
<p>What about conventional syntax?</p>
<p>Well, it has the benefit over the previous attempt that we don't have to make up names for things. And it looks like a conventional (functional) programming language.</p>
<p>But in fact I think this is a problem. Whatever cellular is, it probably had better <em>not</em> look like a conventional programming language. Spreadsheet programmers don't get programming languages, otherwise they'd be programmers.</p>
<p>My hypothesis here is that -- if we go back to the original tax calculation -- spreadsheet programmers think in a dataflow model. They start with the data (because it's concrete!) then that data is transformed in some way, then it's transformed in some other way, until we get to the answer.</p>
<p>In contrast, the standard nested functional application is precisely the other way round: it says do X to the result of doing Y to the result of doing Z to A. Of course, we could unwrap the functions by naming the arguments -- but then we're back to the naming problem.</p>
</aside>
</section>
<section id="from-program-to-spreadsheet-ii" class="slide level2">
<h1>From program to spreadsheet (II)</h1>
<p>Why not just write the spreadsheet as if you were writing a spreadsheet?</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span class="dv">21000</span>             <span class="co">; Salary</span>
<span class="dv">11000</span>             <span class="co">; Personal allowance</span>
<span class="kw">-</span>                 <span class="co">; = Taxable income</span>
<span class="fl">0.20</span>              <span class="co">; Basic rate</span>
*                 <span class="co">; = Tax payable </span></code></pre></div>
<ul>
<li><p>No names; intuitive ordering</p></li>
<li><p>Direct translation to spreadsheet graph</p></li>
<li><p>But postfix languages haven't caught on. Why not?</p></li>
</ul>
<p>Still missing lambda abstractions, iteration, etc. But just as powerful as spreadsheet. Perhaps a good intermediate representation? (Provisional name &quot;nocell&quot;.)</p>
<aside class="notes">

</aside>
</section>
<section id="how-do-we-add-real-language-features" class="slide level2">
<h1>How do we add &quot;real&quot; language features?</h1>
<ol type="1">
<li><p>&quot;Compile&quot; a language to &quot;nocell&quot;.</p>
<ul>
<li>Unwrap loops, expand functions, ...</li>
</ul></li>
<li><p>Or make &quot;cell&quot; a &quot;nocell&quot;-generating language</p>
<ul>
<li><p>&quot;Spreadsheets as values&quot;</p></li>
<li><p>More interactive</p></li>
</ul></li>
</ol>
</section>
<section id="uncertainty" class="slide level2">
<h1>Uncertainty</h1>
<ul>
<li><p>Don't reinvent the wheel</p></li>
<li><p>Use existing language</p></li>
</ul>
</section>
<section id="broad-architecture" class="slide level2">
<h1>Broad architecture</h1>
<p>Without uncertainty:</p>
<figure>
<img src="images/graphviz/languages.png" />
</figure>
<p>With uncertainty:</p>
<figure>
<img src="images/graphviz/languages-with-p.png" />
</figure>
</section>
<section id="further-thoughts" class="slide level2">
<h1>Further thoughts</h1>
<ol type="1">
<li><p>Layout is half the battle but if solved would encourage adoption.</p>
<ul>
<li>&quot;LaTeX for spreadsheets&quot;</li>
</ul></li>
<li><p>&quot;Compilation&quot; vs &quot;Generation&quot;.</p></li>
<li><p>How to represent uncertain parameters in &quot;ordinary&quot; Excel?</p>
<ul>
<li>Or compile a &quot;probabilistic 'cell'&quot;?</li>
</ul></li>
</ol>
</section>
<section id="what-i-think-is-necessary-for-success" class="slide level2">
<h1>What I think is necessary for success</h1>
<ul>
<li><p>Must extend the &quot;natural&quot; language of spreadsheets</p></li>
<li><p>Must allow incremental transition from easy to abstract</p></li>
<li><p>Must be interactive</p>
<ul>
<li>eg, a &quot;REPL&quot; that generates a spreadsheet each time</li>
</ul></li>
<li><p>Must make some tasks <em>easier</em>. eg,</p>
<ul>
<li><p>Formatting tables (always a pain);</p></li>
<li><p>Make probabilistic calculations possible.</p></li>
</ul></li>
</ul>
</section>
<section id="other-proposals" class="slide level2">
<h1>Other proposals</h1>
<ul>
<li><p>Gencel (templates for Excel)</p></li>
<li><p>User-centred functions (SPJ)</p></li>
<li><p>ModelSheet Authoring (specific kinds of models)</p></li>
<li><p>Tabular</p></li>
<li><p>Improv</p></li>
<li><p>Scenarios (FW)</p></li>
</ul>
<aside class="notes">
<p>One good question to ask is: what haven't these succeeded?</p>
<ul>
<li><p>Maybe they will, just not yet?</p></li>
<li><p>They involve changing the spreadsheet model</p></li>
<li>They involve extensions to Excel (breaks collaboration)</li>
</ul>
</aside>
<!-- ============================= CHALLENGES ============================= -->
</section>
<section id="unused-slides" class="slide level2">
<h1>UNUSED SLIDES</h1>
</section>
<section id="other-kinds-of-models" class="slide level2">
<h1>Other kinds of models</h1>
<ul>
<li><p>Maximisation</p></li>
<li><p>Dynamic simulation</p></li>
<li><p>Agent-based simulation</p></li>
<li><p>Equilibrium-finding</p></li>
<li><p>“Full” Bayesian inference</p></li>
</ul>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: false,
        // Vertical centering of slides
        center: true,
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom
        // Transition speed
        transitionSpeed: 'fast', // default/fast/slow

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
